# Heap_3 Challenge

## Introduction

Heap_3 is a challenge that involves exploiting a Use-After-Free (UAF) vulnerability to gain control over a program's behavior. The goal is to modify a specific buffer's value in memory, which will trigger the program to print a flag.

## Challenge Overview

- The program contains a struct with multiple buffers, one of which contains the flag.
- It allocates memory for the struct with a specific size (35 bytes).
- The program provides a utility to free the memory allocated for the struct, allowing for a potential UAF vulnerability.
- By carefully manipulating the heap, it's possible to free and then reallocate memory in a way that allows writing to the buffer containing the flag.

## Exploitation Steps

1. **Analyze the Source Code:** Examine the source code to understand the structure of the program, including the struct layout and memory allocation/deallocation logic.

2. **Identify the Vulnerability:** Notice that the program allows you to free and reallocate memory for the struct. This behavior can lead to a UAF vulnerability if not handled correctly.

3. **Free and Reallocate Memory:** Use the program's feature to free the memory allocated for the struct and then reallocate it with a different size, possibly overlapping other buffers.

4. **Pad the Allocated Memory:** Since there are three other buffers of length 10 each behind the flag buffer, you need to allocate an additional 30 bytes of padding to reach the flag buffer.

5. **Modify the Flag Buffer:** Now that you can control the allocation size, reallocate the memory in a way that allows you to overwrite the buffer containing the flag.

6. **Trigger the Print Function:** By modifying the flag buffer to the correct value ("pico"), you can trigger the program to print the flag when the `check_win` function is called.
